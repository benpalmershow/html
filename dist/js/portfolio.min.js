document.addEventListener("DOMContentLoaded",(function(){const t=document.getElementById("portfolio-table-container"),e=document.getElementById("loading-message"),n=document.getElementById("error-message"),o=document.getElementById("last-updated-portfolio");!async function(){e.style.display="block",n.style.display="none",t.innerHTML="";try{const n=await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vT6z_p9IuSfz8-mFdOtKMNbmuqli7-EVaIDy9PiDkw-mneYgAmVroJEx5PGtUDEhYldcsnVyKLR5R2n/pub?gid=1020374850&single=true&output=csv");if(!n.ok)throw new Error(`HTTP error!status:${n.status}`);const a=function(t){const e=t.split("\n"),n=[];let o=!1;for(const t of e){const e=t.trim();if(""===e){if(n.length>0&&o)break;continue}const a=[];let l=!1,s="";for(let t=0;t<e.length;t++){const n=e[t];'"'===n?l=!l:","!==n||l?s+=n:(a.push(s.trim()),s="")}a.push(s.trim()),a.some((t=>"string"==typeof t&&t.toUpperCase().includes("CCL")))&&(o=!0),a.some((t=>""!==t))&&n.push(a)}return n}(await n.text());!function(e){if(!e||e.length<2)return void(t.innerHTML="<p>No data available to display.</p>");const n=document.createElement("table"),o=document.createElement("thead"),a=document.createElement("tbody"),l=e[0],s=document.createElement("tr");l.forEach((t=>{const e=document.createElement("th");e.textContent=t,s.appendChild(e)})),o.appendChild(s),n.appendChild(o);for(let t=1;t<e.length;t++){const n=e[t];if(n.every((t=>""===t)))continue;const o=document.createElement("tr");n.forEach(((t,e)=>{const n=document.createElement("td");if(0===e&&t&&""!==t.trim()){const e=t.trim();if(e.length<=5&&e.match(/^[A-Z]+$/)){const t=document.createElement("a");t.href=`https://finance.yahoo.com/quote/${e}`,t.target="_blank",t.rel="noopener",t.textContent=e,n.appendChild(t)}else n.textContent=t}else n.textContent=t;e>=1&&t&&(t.includes("$")||t.includes("%")||!isNaN(parseFloat(t.replace(/[$,%]/g,""))))&&n.classList.add("number"),o.appendChild(n)})),a.appendChild(o)}n.appendChild(a),t.appendChild(n)}(a),e.style.display="none";const l=new Date;o.textContent=`Portfolio data refreshed automatically.Last updated:${l.toLocaleTimeString()}on ${l.toLocaleDateString()}`}catch(t){a=t.message,e.style.display="none",n.textContent="Error loading portfolio data:"+a,n.style.display="block"}var a}()}));