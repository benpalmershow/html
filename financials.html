<!DOCTYPE html>
<html lang="en">

<head>
  <!-- COMPONENT: components/head-meta.html -->
  <script>
    fetch('components/head-meta.html')
      .then(response => response.text())
      .then(html => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const content = doc.body.innerHTML;
        if (content) {
          document.head.insertAdjacentHTML('afterbegin', content);
        }
      })
      .catch(error => console.error('head-meta load error:', error));
  </script>

  <!-- Page-specific Meta Tags -->
  <title>Financial Data & Market Indicators - Howdy, Stranger</title>
  <meta name="description" content="Real-time financial data, market indicators, and 13F holdings analysis from The Ben Palmer Show.">

  <!-- COMPONENT: components/fonts.html -->
  <script>
    fetch('components/fonts.html')
      .then(response => response.text())
      .then(html => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const links = doc.querySelectorAll('link');
        links.forEach(link => {
          const newLink = document.createElement('link');
          newLink.rel = link.rel;
          newLink.href = link.href;
          if (link.as) newLink.as = link.as;
          if (link.onload) newLink.onload = link.onload;
          document.head.appendChild(newLink);
        });
      })
      .catch(error => console.error('fonts load error:', error));
  </script>

  <!-- Critical CSS -->
  <link rel="preload" href="css/body.css?v=20251220" as="style" onload="this.rel='stylesheet'">
  <link rel="preload" href="css/nav.css?v=20251220" as="style" onload="this.rel='stylesheet'">
  <link rel="preload" href="css/financials.css?v=20251220" as="style" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="css/body.css?v=20251220"><link rel="stylesheet" href="css/nav.css?v=20251220"><link rel="stylesheet" href="css/financials.css?v=20251220"></noscript>

  <!-- Preload critical resources -->
  <link rel="preload" href="js/task-scheduler.js" as="script">
  <link rel="preload" href="js/utils.js" as="script">
  <link rel="preload" href="js/indicators.js" as="script">
  <link rel="preload" href="js/charts.js" as="script">
  <link rel="preload" href="js/filters.js" as="script">
  <link rel="preload" href="js/13f-holdings.js" as="script">
  <link rel="preload" href="js/financials.js" as="script">
  <link rel="preload" href="js/nav.js" as="script">
  <link rel="preload" href="js/countdown.js" as="script">

  <!-- COMPONENT: components/analytics.html -->
  <script>
    fetch('components/analytics.html')
      .then(response => response.text())
      .then(html => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const scripts = doc.querySelectorAll('script');
        scripts.forEach(script => {
          const newScript = document.createElement('script');
          if (script.textContent) {
            newScript.textContent = script.textContent;
          }
          if (script.src) {
            newScript.src = script.src;
          }
          if (script.type) {
            newScript.type = script.type;
          }
          document.head.appendChild(newScript);
        });
      })
      .catch(error => console.error('analytics load error:', error));
  </script>

  <!-- Vercel Insights - Production only -->
  <script>
    if (typeof window !== 'undefined' && window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
      const script = document.createElement('script');
      script.src = '/_vercel/insights/script.js';
      script.defer = true;
      document.head.appendChild(script);
    }
  </script>

  <!-- Chart.js for interactive charts (loaded asynchronously after page content) -->
  <script>
    // Load Chart.js asynchronously to avoid blocking main thread
    window.addEventListener('load', () => {
      const script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/npm/chart.js';
      script.async = true;
      document.head.appendChild(script);
    });
  </script>

  <!-- Infogram Embed Script (deferred) -->
  <script defer>
    ! function (e, n, i, s) {
      var d = "InfogramEmbeds";
      var o = e.getElementsByTagName(n)[0];
      if (window[d] && window[d].initialized)
        window[d].process && window[d].process();
      else if (!e.getElementById(i)) {
        var r = e.createElement(n);
        r.async = 1,
          r.id = i,
          r.src = s,
          o.parentNode.insertBefore(r, o)
      }
    }(document, "script", "infogram-async",
      "https://e.infogram.com/js/dist/embed-loader-min.js");
  </script>

  <!-- Lucide Icons -->
  <script src="https://cdn.jsdelivr.net/npm/lucide@0.400.0/dist/umd/lucide.js" async></script>

  <!-- Performance monitoring -->
  <script src="js/speed-insights.js" defer></script>

</head>

<body>

  <nav class="nav-links" id="main-nav"></nav>
  <div class="page-title page-title--bordered"><i data-lucide="bar-chart-3" aria-hidden="true"
      class="page-icon"></i>Numbers</div>
  <main class="container">
    <div class="collapsible-container">

      <div class="collapsible-content" id="interactive-dashboard-content">
        <div class="filters" id="filters">
          <div class="filters-wrapper">
            <div class="filter-group mobile-filters">
              <button class="filter-btn filter-category-btn" id="categoryBtn">
                <i data-lucide="list" class="filter-icon" aria-hidden="true"></i>
                <span class="filter-text">Filter By</span>
                <i data-lucide="chevron-down" class="filter-dropdown-icon" aria-hidden="true"></i>
              </button>
              <div class="filter-dropdown" id="categoryDropdown">
                <!-- Populated by JavaScript -->
              </div>
            </div>
            <div class="desktop-filters" id="desktopFilters">
              <!-- Desktop buttons will be injected here -->
            </div>
          </div>
        </div>

        <div id="lastUpdated" class="last-updated"></div>

        <div class="categories" id="categories"></div>

        <!-- 13F Holdings Section -->
         <div class="category" id="latest-13f-filings" data-category="13F Holdings">
           <h2 class="category-title">
             <span class="category-icon"><i data-lucide="building-2" aria-hidden="true"></i></span>
             <span class="category-name">13F Holdings</span>
           </h2>
          <div class="indicators-grid" id="firmCardsContainer">
          </div>
        </div>

        <!-- Chart Modal Popup -->
        <div id="chartModal" class="chart-modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
          <div class="chart-modal-content">
            <div class="chart-modal-header">
              <h3 id="modal-title">
                <i data-lucide="trending-up" aria-hidden="true"></i>
              </h3>
              <button id="closeChartModal" aria-label="Close">&times;</button>
            </div>
            <div class="chart-modal-body">
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- COMPONENT: components/footer.html -->
  <script>
    fetch('components/footer.html')
      .then(response => response.text())
      .then(html => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const footer = doc.querySelector('footer');
        if (footer) {
          document.body.appendChild(footer);
        }
      })
      .catch(error => console.error('Footer load error:', error));
  </script>

  <!-- COMPONENT: components/error-handling.html -->
  <script>
    fetch('components/error-handling.html')
      .then(response => response.text())
      .then(html => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const scripts = doc.querySelectorAll('script');
        scripts.forEach(script => {
          const newScript = document.createElement('script');
          if (script.textContent) {
            newScript.textContent = script.textContent;
          }
          if (script.src) {
            newScript.src = script.src;
          }
          if (script.type) {
            newScript.type = script.type;
          }
          document.body.appendChild(newScript);
        });
      })
      .catch(error => console.error('error-handling load error:', error));
  </script>

  <!-- COMPONENT: components/scripts-unified.html -->
  <script>
    fetch('components/scripts-unified.html')
      .then(response => response.text())
      .then(html => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const scripts = doc.querySelectorAll('script');
        scripts.forEach(script => {
          const newScript = document.createElement('script');
          if (script.textContent) {
            newScript.textContent = script.textContent;
          }
          if (script.src) {
            newScript.src = script.src;
            if (script.hasAttribute('defer')) newScript.defer = true;
          }
          if (script.type) {
            newScript.type = script.type;
          }
          document.body.appendChild(newScript);
        });
      })
      .catch(error => console.error('scripts-unified load error:', error));
  </script>

  <!-- Financials Module Scripts (loaded in dependency order) -->
  <script src="js/task-scheduler.js" defer></script>
  <script src="js/utils.js" defer></script>
  <script src="js/indicators.js" defer></script>
  <script src="js/charts.js" defer></script>
  <script src="js/filters.js" defer></script>
  <script src="js/13f-holdings.js" defer></script>
  <script src="js/financials.js" defer></script>

  <!-- Navigation script -->
  <script src="js/nav.js" defer></script>
  <script src="js/countdown.js" defer></script>

</body>

</html>