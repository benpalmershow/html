<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Common Meta Tags Component -->
  <script>
    fetch('components/head-meta.html')
      .then(response => response.text())
      .then(html => {
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = html;
        const metaElements = tempDiv.querySelectorAll('meta, link');
        metaElements.forEach(element => {
          document.head.appendChild(element.cloneNode(true));
        });
      })
      .catch(error => console.error('Meta tags load error:', error));
  </script>

  <!-- Page-specific Meta Tags -->
  <meta name="description"
    content="Curated books, films, and podcasts worth your time from The Ben Palmer Show. Independent media recommendations.">
  <meta name="keywords" content="media, books, films, podcasts, recommendations, Ben Palmer Show, curated content">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Open Graph Meta Tags -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Media - Howdy, Stranger">
  <meta property="og:description"
    content="Curated books, films, and podcasts worth your time from The Ben Palmer Show. Independent media recommendations.">
  <meta property="og:url" content="https://howdystranger.net/media.html">
  <meta property="og:site_name" content="Howdy, Stranger">
  <meta property="og:image" content="https://howdystranger.net/images/logo-1200x630.webp?v=1">
  <meta property="og:image:alt" content="Howdy, Stranger - Curated Media Recommendations">

  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@DocRiter">
  <meta name="twitter:creator" content="@DocRiter">
  <meta name="twitter:title" content="Media - Howdy, Stranger">
  <meta name="twitter:description"
    content="Curated books, films, and podcasts worth your time from The Ben Palmer Show. Independent media recommendations.">
  <meta name="twitter:image" content="https://howdystranger.net/images/logo-1200x630.webp?v=1">
  <meta name="twitter:image:alt" content="Howdy, Stranger - Curated Media Recommendations">

  <!-- Canonical URL -->
  <link rel="canonical" href="https://howdystranger.net/media.html">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="images/favicon.ico">
  <link rel="icon" type="image/webp" sizes="32x32" href="images/favicon-32x32.webp">

  <!-- Theme Color -->
  <meta name="theme-color" content="#2c5f5a">

  <!-- Preconnect to external domains - CRITICAL for performance -->
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="preconnect" href="https://d28hgpri8am2if.cloudfront.net">

  <!-- Typography System Fonts Component -->
  <script>
    fetch('components/fonts.html')
      .then(response => response.text())
      .then(html => {
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = html;
        const linkElements = tempDiv.querySelectorAll('link');
        linkElements.forEach(element => {
          document.head.appendChild(element.cloneNode(true));
        });
      })
      .catch(error => console.error('Fonts load error:', error));
  </script>

  <!-- Preload CRITICAL resources only -->
  <link rel="preload" href="css/body.css?v=20251220" as="style">
  <link rel="preload" href="css/nav.css?v=20251220" as="style">
  <link rel="preload" href="css/media.css?v=20251220" as="style">

  <!-- Preload Font Awesome fonts -->
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/webfonts/fa-solid-900.woff2"
    as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/webfonts/fa-brands-400.woff2"
    as="font" type="font/woff2" crossorigin>

  <!-- Preload critical scripts -->
  <link rel="preload" href="js/nav.js" as="script">
  <link rel="preload" href="js/media.js" as="script">

  <!-- Critical CSS -->
  <link rel="stylesheet" href="css/body.css?v=20251220">
  <link rel="stylesheet" href="css/nav.css?v=20251220">
  <link rel="stylesheet" href="css/media.css?v=20251220">
  <link rel="stylesheet" href="css/media-overlay.css?v=20251220">

  <!-- Font Awesome - load async -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" media="print" onload="this.media='all'">

  <title>Media - Howdy, Stranger</title>

  <!-- Analytics Component -->
  <script>
    fetch('components/analytics.html')
      .then(response => response.text())
      .then(html => {
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = html;
        const scriptElements = tempDiv.querySelectorAll('script');
        scriptElements.forEach(script => {
          const newScript = document.createElement('script');
          newScript.textContent = script.textContent;
          document.head.appendChild(newScript);
        });
      })
      .catch(error => console.error('Analytics load error:', error));
  </script>



  <!-- Error Handling Component -->
  <script>
    fetch('components/error-handling.html')
      .then(response => response.text())
      .then(html => {
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = html;
        const scriptElements = tempDiv.querySelectorAll('script');
        scriptElements.forEach(script => {
          const newScript = document.createElement('script');
          newScript.textContent = script.textContent;
          document.head.appendChild(newScript);
        });
      })
      .catch(error => console.error('Error Handling load error:', error));
  </script>


  <!-- Inline critical CSS for LCP -->
  <style>
    /* Critical styles for first paint */
    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: var(--color-primary, #2c5f5a);
      color: white;
      padding: 8px 16px;
      text-decoration: none;
      z-index: 100;
      border-radius: 0 0 4px 0;
    }

    .skip-link:focus {
      top: 0;
    }

    .media-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 1.5rem;
      padding: 2rem;
    }

    @media (max-width: 768px) {
      .media-cards {
        grid-template-columns: repeat(2, 1fr);
      }

      .media-card {
        max-width: none;
      }
    }

    .media-card {
      max-width: 150px;
      width: 100%;
      border-radius: 0.5rem;
      contain: layout style paint;
    }

    .media-cover-container {
      position: relative;
      width: 100%;
      aspect-ratio: 1;
      overflow: hidden;
      border-radius: 0.5rem;
      contain: layout;
      background: #2C5F5A;
    }

    .media-cover {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      border-radius: 0.5rem;
    }

    .loading-state {
      text-align: center;
      padding: 3rem;
      font-size: 1.2rem;
    }

    .fa-spinner {
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    /* Search input styles */
    .search-label {
      position: relative;
      width: 100%;
    }

    .search-label input {
      padding-right: 2.5rem;
    }

    .search-icon {
      position: absolute;
      right: 0.8rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--color-gray-500, #6c757d);
      pointer-events: none;
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border-width: 0;
    }

    /* Font optimization */
    @font-face {
      font-family: 'FontAwesome';
      src: url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/webfonts/fa-solid-900.woff2') format('woff2');
      font-weight: 900;
      font-display: swap;
      size-adjust: 95%;
    }

    @font-face {
      font-family: 'FontAwesome Brands';
      src: url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/webfonts/fa-brands-400.woff2') format('woff2');
      font-weight: 400;
      font-display: swap;
      size-adjust: 95%;
    }
  </style>

</head>

<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <nav class="nav-links" id="main-nav"></nav>

  <main id="main-content" tabindex="-1">
    <h1 class="page-title page-title--bordered" aria-label="Page title">
      <picture>
        <source srcset="images/media-60x60.webp" type="image/webp">
        <img src="images/media-60x60.webp" alt="Media icon" class="page-icon" width="40" height="40" loading="eager">
      </picture>
      Media
    </h1>
    <div class="media-filters">
      <label for="search-input" class="search-label">
        <span class="sr-only">Search media</span>
        <input type="text" id="search-input" placeholder="Search by title, author, or description..."
          aria-label="Search media items" autocomplete="off">
        <i class="fas fa-search search-icon" aria-hidden="true"></i>
      </label>

      <label>Filter by type:
        <select id="filter-type" aria-label="Filter by media type">
          <option value="all">All</option>
        </select>
      </label>

      <label>Sort by:
        <select id="sort-by" aria-label="Sort media">
          <option value="date-desc">Newest by Date Added</option>
          <option value="title-asc">Title (A-Z)</option>
        </select>
      </label>
    </div>

    <div class="media-cards" id="media-cards-container">
      <!-- Media cards will be inserted here by JavaScript -->
    </div>

    <div id="playlist-overlay" class="playlist-overlay" style="display: none;" role="dialog" aria-modal="true"
      aria-labelledby="overlay-title">
      <div class="playlist-overlay-content">
        <h2 id="overlay-title"></h2>
        <ul id="overlay-songs" class="overlay-songs" role="list"></ul>
      </div>
    </div>
  </main>

  <!-- Footer Component -->
  <div id="footer-container"></div>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      fetch('components/footer.html')
        .then(response => response.text())
        .then(html => {
          document.getElementById('footer-container').innerHTML = html;
        })
        .catch(error => {
          console.error('Footer load error:', error);
        });
    });
  </script>

  <!-- Unified Scripts Component -->
  <script>
    fetch('components/scripts-unified.html')
      .then(response => response.text())
      .then(html => {
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = html;
        const scriptElements = tempDiv.querySelectorAll('script');
        scriptElements.forEach(script => {
          const newScript = document.createElement('script');
          newScript.textContent = script.textContent;
          document.head.appendChild(newScript);
        });
      })
      .catch(error => console.error('Scripts load error:', error));
  </script>

  <!-- Load scripts - nav and socials defer but load quickly for header/footer -->
  <script src="js/nav.js" defer></script>

  <script src="js/media.js"></script>

  <!-- Load Lucide icons on-demand after page load -->
  <script>
    (function () {
      const loadLucide = () => {
        if (window.lucide) return;
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/lucide@0.400.0/dist/umd/lucide.js';
        script.defer = true;
        script.onload = () => window.lucide?.createIcons();
        document.head.appendChild(script);
      };

      if ('requestIdleCallback' in window) {
        requestIdleCallback(loadLucide, { timeout: 3000 });
      } else {
        setTimeout(loadLucide, 100);
      }
    })();
  </script>

  <!-- Load non-critical analytics after idle -->
  <script>
    const loadNonCriticalScripts = () => {
      const speedInsights = document.createElement('script');
      speedInsights.src = 'js/speed-insights.js';
      speedInsights.type = 'module';
      speedInsights.defer = true;
      document.body.appendChild(speedInsights);
    };

    if ('requestIdleCallback' in window) {
      requestIdleCallback(loadNonCriticalScripts);
    } else {
      window.addEventListener('load', () => setTimeout(loadNonCriticalScripts, 1000));
    }
  </script>


</body>

</html>